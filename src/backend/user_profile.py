import json

class UserProfile:
    def __init__(self, profiles_file):
        self.profiles_file = profiles_file
        self.profiles = self.load_profiles()

    def load_profiles(self):
        try:
            with open(self.profiles_file, 'r') as file:
                profiles = json.load(file)
        except FileNotFoundError:
            profiles = {}
        return profiles

    def save_profiles(self):
        with open(self.profiles_file, 'w') as file:
            json.dump(self.profiles, file, indent=4)

    def get_profile(self, username):
        return self.profiles.get(username, None)

    def update_profile(self, username, profile_info):
        if username not in self.profiles:
            raise ValueError("Profile does not exist")
        self.profiles[username] = profile_info
        self.save_profiles()

    def create_profile(self, username, profile_info):
        if username in self.profiles:
            raise ValueError("Profile already exists")
        self.profiles[username] = profile_info
        self.save_profiles()

    def delete_profile(self, username):
        if username not in self.profiles:
            raise ValueError("Profile does not exist")
        del self.profiles[username]
        self.save_profiles()
