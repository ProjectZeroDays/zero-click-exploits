import logging
from docxtpl import DocxTemplate
import os

class ReportGenerator:
    def __init__(self, template_dir, report_dir):
        self.template_dir = template_dir
        self.report_dir = report_dir
        self.logger = logging.getLogger(__name__)
        self.logger.setLevel(logging.INFO)
        handler = logging.FileHandler('report_generator.log')
        handler.setLevel(logging.INFO)
        formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')
        handler.setFormatter(formatter)
        self.logger.addHandler(handler)

    def generate_report(self, template_name, report_name, context):
        template_path = os.path.join(self.template_dir, template_name)
        report_path = os.path.join(self.report_dir, report_name)
        doc = DocxTemplate(template_path)
        doc.render(context)
        doc.save(report_path)
        self.logger.info(f"Report generated: {report_path}")

    def example_usage(self):
        template_name = 'executive-summary-template.docx'
        report_name = 'example-report.docx'
        context = {
            'title': 'Executive Summary',
            'date': '2023-09-30',
            'summary': 'This is an example executive summary report.'
        }
        self.generate_report(template_name, report_name, context)

if __name__ == "__main__":
    report_generator = ReportGenerator('templates', 'reports')
    report_generator.example_usage()
